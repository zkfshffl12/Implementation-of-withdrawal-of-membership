version: '3.8'

services:
  soju-app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: soju-app
    ports:
      - "8080:8080"
      - "5173:5173"
    environment:
      # Spring 프로필
      SPRING_PROFILES_ACTIVE: prod
      
      # 서버 설정
      SERVER_PORT: 8080
      
      # 데이터베이스 설정 (로컬 Oracle 사용)
      SPRING_DATASOURCE_URL: jdbc:oracle:thin:@host.docker.internal:1521:xe
      SPRING_DATASOURCE_USERNAME: BASAN
      SPRING_DATASOURCE_PASSWORD: oracle
      
      # JVM 옵션
      JAVA_OPTS: "-Xmx1g -Xms512m -XX:+UseG1GC"
    
    # 의존성 (Oracle DB 서비스가 있는 경우)
    # depends_on:
    #   - oracle-db
    
    # 볼륨 마운트 (로그 저장 등)
    volumes:
      - ./logs:/app/logs
    
    # 재시작 정책
    restart: unless-stopped
    
    # 네트워크
    networks:
      - soju-network

  # Oracle DB 서비스 예시 (필요시 주석 해제)
  # oracle-db:
  #   image: gvenzl/oracle-xe:21-slim
  #   container_name: oracle-db
  #   ports:
  #     - "1521:1521"
  #   environment:
  #     ORACLE_PASSWORD: your_oracle_password
  #   volumes:
  #     - oracle-data:/opt/oracle/oradata
  #   networks:
  #     - soju-network

networks:
  soju-network:
    driver: bridge

volumes:
  # oracle-data:
  logs:
